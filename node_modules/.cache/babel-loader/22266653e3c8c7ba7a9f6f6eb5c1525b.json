{"ast":null,"code":"var core = require('./core');\n\nvar fs = require('fs');\n\nvar path = require('path');\n\nvar caller = require('./caller.js');\n\nvar nodeModulesPaths = require('./node-modules-paths.js');\n\nvar normalizeOptions = require('./normalize-options.js');\n\nvar defaultIsFile = function isFile(file, cb) {\n  fs.stat(file, function (err, stat) {\n    if (!err) {\n      return cb(null, stat.isFile() || stat.isFIFO());\n    }\n\n    if (err.code === 'ENOENT' || err.code === 'ENOTDIR') return cb(null, false);\n    return cb(err);\n  });\n};\n\nvar defaultIsDir = function isDirectory(dir, cb) {\n  fs.stat(dir, function (err, stat) {\n    if (!err) {\n      return cb(null, stat.isDirectory());\n    }\n\n    if (err.code === 'ENOENT' || err.code === 'ENOTDIR') return cb(null, false);\n    return cb(err);\n  });\n};\n\nvar maybeUnwrapSymlink = function maybeUnwrapSymlink(x, opts, cb) {\n  if (opts && opts.preserveSymlinks === false) {\n    fs.realpath(x, function (realPathErr, realPath) {\n      if (realPathErr && realPathErr.code !== 'ENOENT') cb(realPathErr);else cb(null, realPathErr ? x : realPath);\n    });\n  } else {\n    cb(null, x);\n  }\n};\n\nmodule.exports = function resolve(x, options, callback) {\n  var cb = callback;\n  var opts = options;\n\n  if (typeof options === 'function') {\n    cb = opts;\n    opts = {};\n  }\n\n  if (typeof x !== 'string') {\n    var err = new TypeError('Path must be a string.');\n    return process.nextTick(function () {\n      cb(err);\n    });\n  }\n\n  opts = normalizeOptions(x, opts);\n  var isFile = opts.isFile || defaultIsFile;\n  var isDirectory = opts.isDirectory || defaultIsDir;\n  var readFile = opts.readFile || fs.readFile;\n  var extensions = opts.extensions || ['.js'];\n  var basedir = opts.basedir || path.dirname(caller());\n  var parent = opts.filename || basedir;\n  opts.paths = opts.paths || []; // ensure that `basedir` is an absolute path at this point, resolving against the process' current working directory\n\n  var absoluteStart = path.resolve(basedir);\n  maybeUnwrapSymlink(absoluteStart, opts, function (err, realStart) {\n    if (err) cb(err);else init(realStart);\n  });\n  var res;\n\n  function init(basedir) {\n    if (/^(?:\\.\\.?(?:\\/|$)|\\/|([A-Za-z]:)?[/\\\\])/.test(x)) {\n      res = path.resolve(basedir, x);\n      if (x === '..' || x.slice(-1) === '/') res += '/';\n\n      if (/\\/$/.test(x) && res === basedir) {\n        loadAsDirectory(res, opts.package, onfile);\n      } else loadAsFile(res, opts.package, onfile);\n    } else loadNodeModules(x, basedir, function (err, n, pkg) {\n      if (err) cb(err);else if (core[x]) return cb(null, x);else if (n) {\n        return maybeUnwrapSymlink(n, opts, function (err, realN) {\n          if (err) {\n            cb(err);\n          } else {\n            cb(null, realN, pkg);\n          }\n        });\n      } else {\n        var moduleError = new Error(\"Cannot find module '\" + x + \"' from '\" + parent + \"'\");\n        moduleError.code = 'MODULE_NOT_FOUND';\n        cb(moduleError);\n      }\n    });\n  }\n\n  function onfile(err, m, pkg) {\n    if (err) cb(err);else if (m) cb(null, m, pkg);else loadAsDirectory(res, function (err, d, pkg) {\n      if (err) cb(err);else if (d) {\n        maybeUnwrapSymlink(d, opts, function (err, realD) {\n          if (err) {\n            cb(err);\n          } else {\n            cb(null, realD, pkg);\n          }\n        });\n      } else {\n        var moduleError = new Error(\"Cannot find module '\" + x + \"' from '\" + parent + \"'\");\n        moduleError.code = 'MODULE_NOT_FOUND';\n        cb(moduleError);\n      }\n    });\n  }\n\n  function loadAsFile(x, thePackage, callback) {\n    var loadAsFilePackage = thePackage;\n    var cb = callback;\n\n    if (typeof loadAsFilePackage === 'function') {\n      cb = loadAsFilePackage;\n      loadAsFilePackage = undefined;\n    }\n\n    var exts = [''].concat(extensions);\n    load(exts, x, loadAsFilePackage);\n\n    function load(exts, x, loadPackage) {\n      if (exts.length === 0) return cb(null, undefined, loadPackage);\n      var file = x + exts[0];\n      var pkg = loadPackage;\n      if (pkg) onpkg(null, pkg);else loadpkg(path.dirname(file), onpkg);\n\n      function onpkg(err, pkg_, dir) {\n        pkg = pkg_;\n        if (err) return cb(err);\n\n        if (dir && pkg && opts.pathFilter) {\n          var rfile = path.relative(dir, file);\n          var rel = rfile.slice(0, rfile.length - exts[0].length);\n          var r = opts.pathFilter(pkg, x, rel);\n          if (r) return load([''].concat(extensions.slice()), path.resolve(dir, r), pkg);\n        }\n\n        isFile(file, onex);\n      }\n\n      function onex(err, ex) {\n        if (err) return cb(err);\n        if (ex) return cb(null, file, pkg);\n        load(exts.slice(1), x, pkg);\n      }\n    }\n  }\n\n  function loadpkg(dir, cb) {\n    if (dir === '' || dir === '/') return cb(null);\n\n    if (process.platform === 'win32' && /^\\w:[/\\\\]*$/.test(dir)) {\n      return cb(null);\n    }\n\n    if (/[/\\\\]node_modules[/\\\\]*$/.test(dir)) return cb(null);\n    maybeUnwrapSymlink(dir, opts, function (unwrapErr, pkgdir) {\n      if (unwrapErr) return loadpkg(path.dirname(dir), cb);\n      var pkgfile = path.join(pkgdir, 'package.json');\n      isFile(pkgfile, function (err, ex) {\n        // on err, ex is false\n        if (!ex) return loadpkg(path.dirname(dir), cb);\n        readFile(pkgfile, function (err, body) {\n          if (err) cb(err);\n\n          try {\n            var pkg = JSON.parse(body);\n          } catch (jsonErr) {}\n\n          if (pkg && opts.packageFilter) {\n            pkg = opts.packageFilter(pkg, pkgfile);\n          }\n\n          cb(null, pkg, dir);\n        });\n      });\n    });\n  }\n\n  function loadAsDirectory(x, loadAsDirectoryPackage, callback) {\n    var cb = callback;\n    var fpkg = loadAsDirectoryPackage;\n\n    if (typeof fpkg === 'function') {\n      cb = fpkg;\n      fpkg = opts.package;\n    }\n\n    maybeUnwrapSymlink(x, opts, function (unwrapErr, pkgdir) {\n      if (unwrapErr) return cb(unwrapErr);\n      var pkgfile = path.join(pkgdir, 'package.json');\n      isFile(pkgfile, function (err, ex) {\n        if (err) return cb(err);\n        if (!ex) return loadAsFile(path.join(x, 'index'), fpkg, cb);\n        readFile(pkgfile, function (err, body) {\n          if (err) return cb(err);\n\n          try {\n            var pkg = JSON.parse(body);\n          } catch (jsonErr) {}\n\n          if (pkg && opts.packageFilter) {\n            pkg = opts.packageFilter(pkg, pkgfile);\n          }\n\n          if (pkg && pkg.main) {\n            if (typeof pkg.main !== 'string') {\n              var mainError = new TypeError('package “' + pkg.name + '” `main` must be a string');\n              mainError.code = 'INVALID_PACKAGE_MAIN';\n              return cb(mainError);\n            }\n\n            if (pkg.main === '.' || pkg.main === './') {\n              pkg.main = 'index';\n            }\n\n            loadAsFile(path.resolve(x, pkg.main), pkg, function (err, m, pkg) {\n              if (err) return cb(err);\n              if (m) return cb(null, m, pkg);\n              if (!pkg) return loadAsFile(path.join(x, 'index'), pkg, cb);\n              var dir = path.resolve(x, pkg.main);\n              loadAsDirectory(dir, pkg, function (err, n, pkg) {\n                if (err) return cb(err);\n                if (n) return cb(null, n, pkg);\n                loadAsFile(path.join(x, 'index'), pkg, cb);\n              });\n            });\n            return;\n          }\n\n          loadAsFile(path.join(x, '/index'), pkg, cb);\n        });\n      });\n    });\n  }\n\n  function processDirs(cb, dirs) {\n    if (dirs.length === 0) return cb(null, undefined);\n    var dir = dirs[0];\n    isDirectory(dir, isdir);\n\n    function isdir(err, isdir) {\n      if (err) return cb(err);\n      if (!isdir) return processDirs(cb, dirs.slice(1));\n      var file = path.join(dir, x);\n      loadAsFile(file, opts.package, onfile);\n    }\n\n    function onfile(err, m, pkg) {\n      if (err) return cb(err);\n      if (m) return cb(null, m, pkg);\n      loadAsDirectory(path.join(dir, x), opts.package, ondir);\n    }\n\n    function ondir(err, n, pkg) {\n      if (err) return cb(err);\n      if (n) return cb(null, n, pkg);\n      processDirs(cb, dirs.slice(1));\n    }\n  }\n\n  function loadNodeModules(x, start, cb) {\n    processDirs(cb, nodeModulesPaths(start, opts, x));\n  }\n};","map":{"version":3,"sources":["/home/yanxiaoyang/react-project/PersonalWebsiteTest/node_modules/resolve/lib/async.js"],"names":["core","require","fs","path","caller","nodeModulesPaths","normalizeOptions","defaultIsFile","isFile","file","cb","stat","err","isFIFO","code","defaultIsDir","isDirectory","dir","maybeUnwrapSymlink","x","opts","preserveSymlinks","realpath","realPathErr","realPath","module","exports","resolve","options","callback","TypeError","process","nextTick","readFile","extensions","basedir","dirname","parent","filename","paths","absoluteStart","realStart","init","res","test","slice","loadAsDirectory","package","onfile","loadAsFile","loadNodeModules","n","pkg","realN","moduleError","Error","m","d","realD","thePackage","loadAsFilePackage","undefined","exts","concat","load","loadPackage","length","onpkg","loadpkg","pkg_","pathFilter","rfile","relative","rel","r","onex","ex","platform","unwrapErr","pkgdir","pkgfile","join","body","JSON","parse","jsonErr","packageFilter","loadAsDirectoryPackage","fpkg","main","mainError","name","processDirs","dirs","isdir","ondir","start"],"mappings":"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","sourcesContent":["var core = require('./core');\nvar fs = require('fs');\nvar path = require('path');\nvar caller = require('./caller.js');\nvar nodeModulesPaths = require('./node-modules-paths.js');\nvar normalizeOptions = require('./normalize-options.js');\n\nvar defaultIsFile = function isFile(file, cb) {\n    fs.stat(file, function (err, stat) {\n        if (!err) {\n            return cb(null, stat.isFile() || stat.isFIFO());\n        }\n        if (err.code === 'ENOENT' || err.code === 'ENOTDIR') return cb(null, false);\n        return cb(err);\n    });\n};\n\nvar defaultIsDir = function isDirectory(dir, cb) {\n    fs.stat(dir, function (err, stat) {\n        if (!err) {\n            return cb(null, stat.isDirectory());\n        }\n        if (err.code === 'ENOENT' || err.code === 'ENOTDIR') return cb(null, false);\n        return cb(err);\n    });\n};\n\nvar maybeUnwrapSymlink = function maybeUnwrapSymlink(x, opts, cb) {\n    if (opts && opts.preserveSymlinks === false) {\n        fs.realpath(x, function (realPathErr, realPath) {\n            if (realPathErr && realPathErr.code !== 'ENOENT') cb(realPathErr);\n            else cb(null, realPathErr ? x : realPath);\n        });\n    } else {\n        cb(null, x);\n    }\n};\n\nmodule.exports = function resolve(x, options, callback) {\n    var cb = callback;\n    var opts = options;\n    if (typeof options === 'function') {\n        cb = opts;\n        opts = {};\n    }\n    if (typeof x !== 'string') {\n        var err = new TypeError('Path must be a string.');\n        return process.nextTick(function () {\n            cb(err);\n        });\n    }\n\n    opts = normalizeOptions(x, opts);\n\n    var isFile = opts.isFile || defaultIsFile;\n    var isDirectory = opts.isDirectory || defaultIsDir;\n    var readFile = opts.readFile || fs.readFile;\n\n    var extensions = opts.extensions || ['.js'];\n    var basedir = opts.basedir || path.dirname(caller());\n    var parent = opts.filename || basedir;\n\n    opts.paths = opts.paths || [];\n\n    // ensure that `basedir` is an absolute path at this point, resolving against the process' current working directory\n    var absoluteStart = path.resolve(basedir);\n\n    maybeUnwrapSymlink(\n        absoluteStart,\n        opts,\n        function (err, realStart) {\n            if (err) cb(err);\n            else init(realStart);\n        }\n    );\n\n    var res;\n    function init(basedir) {\n        if ((/^(?:\\.\\.?(?:\\/|$)|\\/|([A-Za-z]:)?[/\\\\])/).test(x)) {\n            res = path.resolve(basedir, x);\n            if (x === '..' || x.slice(-1) === '/') res += '/';\n            if ((/\\/$/).test(x) && res === basedir) {\n                loadAsDirectory(res, opts.package, onfile);\n            } else loadAsFile(res, opts.package, onfile);\n        } else loadNodeModules(x, basedir, function (err, n, pkg) {\n            if (err) cb(err);\n            else if (core[x]) return cb(null, x);\n            else if (n) {\n                return maybeUnwrapSymlink(n, opts, function (err, realN) {\n                    if (err) {\n                        cb(err);\n                    } else {\n                        cb(null, realN, pkg);\n                    }\n                });\n            } else {\n                var moduleError = new Error(\"Cannot find module '\" + x + \"' from '\" + parent + \"'\");\n                moduleError.code = 'MODULE_NOT_FOUND';\n                cb(moduleError);\n            }\n        });\n    }\n\n    function onfile(err, m, pkg) {\n        if (err) cb(err);\n        else if (m) cb(null, m, pkg);\n        else loadAsDirectory(res, function (err, d, pkg) {\n            if (err) cb(err);\n            else if (d) {\n                maybeUnwrapSymlink(d, opts, function (err, realD) {\n                    if (err) {\n                        cb(err);\n                    } else {\n                        cb(null, realD, pkg);\n                    }\n                });\n            } else {\n                var moduleError = new Error(\"Cannot find module '\" + x + \"' from '\" + parent + \"'\");\n                moduleError.code = 'MODULE_NOT_FOUND';\n                cb(moduleError);\n            }\n        });\n    }\n\n    function loadAsFile(x, thePackage, callback) {\n        var loadAsFilePackage = thePackage;\n        var cb = callback;\n        if (typeof loadAsFilePackage === 'function') {\n            cb = loadAsFilePackage;\n            loadAsFilePackage = undefined;\n        }\n\n        var exts = [''].concat(extensions);\n        load(exts, x, loadAsFilePackage);\n\n        function load(exts, x, loadPackage) {\n            if (exts.length === 0) return cb(null, undefined, loadPackage);\n            var file = x + exts[0];\n\n            var pkg = loadPackage;\n            if (pkg) onpkg(null, pkg);\n            else loadpkg(path.dirname(file), onpkg);\n\n            function onpkg(err, pkg_, dir) {\n                pkg = pkg_;\n                if (err) return cb(err);\n                if (dir && pkg && opts.pathFilter) {\n                    var rfile = path.relative(dir, file);\n                    var rel = rfile.slice(0, rfile.length - exts[0].length);\n                    var r = opts.pathFilter(pkg, x, rel);\n                    if (r) return load(\n                        [''].concat(extensions.slice()),\n                        path.resolve(dir, r),\n                        pkg\n                    );\n                }\n                isFile(file, onex);\n            }\n            function onex(err, ex) {\n                if (err) return cb(err);\n                if (ex) return cb(null, file, pkg);\n                load(exts.slice(1), x, pkg);\n            }\n        }\n    }\n\n    function loadpkg(dir, cb) {\n        if (dir === '' || dir === '/') return cb(null);\n        if (process.platform === 'win32' && (/^\\w:[/\\\\]*$/).test(dir)) {\n            return cb(null);\n        }\n        if ((/[/\\\\]node_modules[/\\\\]*$/).test(dir)) return cb(null);\n\n        maybeUnwrapSymlink(dir, opts, function (unwrapErr, pkgdir) {\n            if (unwrapErr) return loadpkg(path.dirname(dir), cb);\n            var pkgfile = path.join(pkgdir, 'package.json');\n            isFile(pkgfile, function (err, ex) {\n                // on err, ex is false\n                if (!ex) return loadpkg(path.dirname(dir), cb);\n\n                readFile(pkgfile, function (err, body) {\n                    if (err) cb(err);\n                    try { var pkg = JSON.parse(body); } catch (jsonErr) {}\n\n                    if (pkg && opts.packageFilter) {\n                        pkg = opts.packageFilter(pkg, pkgfile);\n                    }\n                    cb(null, pkg, dir);\n                });\n            });\n        });\n    }\n\n    function loadAsDirectory(x, loadAsDirectoryPackage, callback) {\n        var cb = callback;\n        var fpkg = loadAsDirectoryPackage;\n        if (typeof fpkg === 'function') {\n            cb = fpkg;\n            fpkg = opts.package;\n        }\n\n        maybeUnwrapSymlink(x, opts, function (unwrapErr, pkgdir) {\n            if (unwrapErr) return cb(unwrapErr);\n            var pkgfile = path.join(pkgdir, 'package.json');\n            isFile(pkgfile, function (err, ex) {\n                if (err) return cb(err);\n                if (!ex) return loadAsFile(path.join(x, 'index'), fpkg, cb);\n\n                readFile(pkgfile, function (err, body) {\n                    if (err) return cb(err);\n                    try {\n                        var pkg = JSON.parse(body);\n                    } catch (jsonErr) {}\n\n                    if (pkg && opts.packageFilter) {\n                        pkg = opts.packageFilter(pkg, pkgfile);\n                    }\n\n                    if (pkg && pkg.main) {\n                        if (typeof pkg.main !== 'string') {\n                            var mainError = new TypeError('package “' + pkg.name + '” `main` must be a string');\n                            mainError.code = 'INVALID_PACKAGE_MAIN';\n                            return cb(mainError);\n                        }\n                        if (pkg.main === '.' || pkg.main === './') {\n                            pkg.main = 'index';\n                        }\n                        loadAsFile(path.resolve(x, pkg.main), pkg, function (err, m, pkg) {\n                            if (err) return cb(err);\n                            if (m) return cb(null, m, pkg);\n                            if (!pkg) return loadAsFile(path.join(x, 'index'), pkg, cb);\n\n                            var dir = path.resolve(x, pkg.main);\n                            loadAsDirectory(dir, pkg, function (err, n, pkg) {\n                                if (err) return cb(err);\n                                if (n) return cb(null, n, pkg);\n                                loadAsFile(path.join(x, 'index'), pkg, cb);\n                            });\n                        });\n                        return;\n                    }\n\n                    loadAsFile(path.join(x, '/index'), pkg, cb);\n                });\n            });\n        });\n    }\n\n    function processDirs(cb, dirs) {\n        if (dirs.length === 0) return cb(null, undefined);\n        var dir = dirs[0];\n\n        isDirectory(dir, isdir);\n\n        function isdir(err, isdir) {\n            if (err) return cb(err);\n            if (!isdir) return processDirs(cb, dirs.slice(1));\n            var file = path.join(dir, x);\n            loadAsFile(file, opts.package, onfile);\n        }\n\n        function onfile(err, m, pkg) {\n            if (err) return cb(err);\n            if (m) return cb(null, m, pkg);\n            loadAsDirectory(path.join(dir, x), opts.package, ondir);\n        }\n\n        function ondir(err, n, pkg) {\n            if (err) return cb(err);\n            if (n) return cb(null, n, pkg);\n            processDirs(cb, dirs.slice(1));\n        }\n    }\n    function loadNodeModules(x, start, cb) {\n        processDirs(cb, nodeModulesPaths(start, opts, x));\n    }\n};\n"]},"metadata":{},"sourceType":"script"}