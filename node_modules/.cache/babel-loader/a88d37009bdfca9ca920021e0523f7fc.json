{"ast":null,"code":"var Args = require(\"vargs\").Constructor,\n    _ = require('lodash'),\n    url = require('url'),\n    JSONWIRE_ERRORS = require('./jsonwire-errors.js');\n\nvar varargs = exports.varargs = function (args) {\n  var fargs = new Args(args); // returning undefined instead of empty callback\n\n  fargs.callback = fargs.callbackGiven() ? fargs.callback : undefined;\n  return fargs;\n}; // small helper to make sure we don't loose exceptions\n// use this instead of looking  the last argument manually\n\n\nexports.findCallback = function (_arguments) {\n  var fargs = varargs(_arguments);\n  return fargs.callback;\n}; // convert to type to something like ById, ByCssSelector, etc...\n\n\nvar STRAT_MAPPING = {\n  '-ios uiautomation': 'ByIosUIAutomation',\n  '-android uiautomator': 'ByAndroidUIAutomator',\n  '-android datamatcher': 'ByAndroidDataMatcher',\n  '-ios class chain': 'ByIosClassChain',\n  '-ios predicate string': 'ByIosPredicateString',\n  '-image': 'ByImage',\n  '-custom': 'ByCustom'\n};\n\nexports.elFuncSuffix = function (type) {\n  var suffix = STRAT_MAPPING[type];\n\n  if (!suffix) {\n    suffix = (' by ' + type).replace(/(\\s[a-z])/g, function ($1) {\n      return $1.toUpperCase().replace(' ', '');\n    }).replace('Xpath', 'XPath');\n  }\n\n  return suffix;\n}; // return correct jsonwire type\n\n\nexports.elFuncFullType = function (type) {\n  if (type === 'css') {\n    return 'css selector';\n  } // shortcut for css\n\n\n  return type;\n}; // from JsonWire spec + shortcuts + mobile JsonWire spec\n\n\nexports.elementFuncTypes = ['class name', 'css selector', 'id', 'name', 'link text', 'partial link text', 'tag name', 'xpath', 'css', '-ios uiautomation', '-android uiautomator', 'accessibility id', '-ios class chain', '-ios predicate string', '-image', '-custom', '-android datamatcher']; // chai-as-promised promisifier\n// just adding the core method for the sake of safety.\\\n// if you need more than that, build your custom promisifier\n\nvar Q_CORE_METHODS = [// core methods:\n\"then\", \"catch\", \"fail\", \"progress\", \"finally\", \"fin\", \"done\", \"thenResolve\", \"thenReject\", \"nodeify\"];\n\nexports.transferPromiseness = function (assertion, promise) {\n  _(Q_CORE_METHODS).each(function (methodName) {\n    if (promise[methodName]) {\n      if (assertion._obj) {\n        assertion._obj[methodName] = promise[methodName].bind(promise);\n      }\n\n      assertion[methodName] = promise[methodName].bind(promise);\n    }\n  });\n\n  if (promise._enrich) {\n    if (assertion._obj) {\n      promise._enrich(assertion._obj);\n    }\n\n    promise._enrich(assertion);\n  }\n}; // promise detection\n\n\nexports.isPromise = function (x) {\n  return (typeof x === \"object\" || typeof x === \"function\") && x !== null && typeof x.then === \"function\";\n};\n\nexports.deprecator = {\n  deprecationMessageShown: {},\n  warnDeprecated: true,\n  showHideDeprecation: function (status) {\n    if (status !== undefined) {\n      this.warnDeprecated = status;\n    } else {\n      this.warnDeprecated = !this.warnDeprecated;\n    }\n  },\n  warn: function (cat, message) {\n    if (this.warnDeprecated && !this.deprecationMessageShown[cat]) {\n      this.deprecationMessageShown[cat] = 1;\n      console.warn(message); // eslint-disable-line no-console\n    }\n  }\n}; // Android doesn't like cariage return\n\nexports.inlineJs = function (script) {\n  return script.replace(/[\\r\\n]/g, '').trim();\n};\n\nexports.resolveUrl = function (from, to) {\n  if (typeof from === 'object') {\n    from = url.format(from);\n  } // making sure the last part of the path doesn't get stripped\n\n\n  if (!from.match(/\\/$/)) {\n    from += '/';\n  }\n\n  return url.parse(url.resolve(from, to));\n};\n\nexports.strip = function strip(str) {\n  if (typeof str !== 'string') {\n    return str;\n  }\n\n  var x = [];\n\n  _(str.length).times(function (i) {\n    if (str.charCodeAt(i)) {\n      x.push(str.charAt(i));\n    }\n  });\n\n  return x.join('');\n};\n\nvar trimToLength = function (str, length) {\n  return str && str.length > length ? str.substring(0, length) + '...' : str;\n};\n\nexports.trimToLength = trimToLength;\n\nexports.niceArgs = function (args) {\n  return JSON.stringify(args).replace(/^\\[/, '(').replace(/\\]$/, ')');\n};\n\nexports.niceResp = function (args) {\n  return JSON.stringify(args).replace(/^\\[/, '').replace(/\\]$/, '');\n}; // convert code to string before execution\n\n\nexports.codeToString = function (code) {\n  if (typeof code === 'function') {\n    code = 'return (' + code + ').apply(null, arguments);';\n  }\n\n  return code;\n};\n\nvar MAX_ERROR_LENGTH = 500;\n\nexports.newError = function (opts) {\n  var err = new Error();\n\n  _.each(opts, function (opt, k) {\n    err[k] = opt;\n  }); // nicer error output\n\n\n  err.inspect = function () {\n    var jsonStr = JSON.stringify(err);\n    return trimToLength(jsonStr, MAX_ERROR_LENGTH);\n  };\n\n  return err;\n};\n\nexports.isWebDriverException = function (res) {\n  return res && res.class && res.class.indexOf('WebDriverException') > 0;\n};\n\nexports.getJsonwireError = function (status) {\n  var jsonwireError = JSONWIRE_ERRORS.filter(function (err) {\n    return err.status === status;\n  });\n  return jsonwireError.length > 0 ? jsonwireError[0] : null;\n};\n/**\n * Prefix all unofficial capabilities. Prefix with `wd` by default\n * or with whatever is provided in `caps.w3cPrefix`\n */\n\n\nexports.prefixCapabilities = function (caps) {\n  var pairs = _.toPairs(caps);\n\n  var prefixedCaps = {};\n  var w3cCapabilities = ['browserName', 'browserVersion', 'platformName', 'acceptInsecureCerts', 'pageLoadStrategy', 'proxy', 'setWindowRect', 'timeouts', 'unhandledPromptBehavior'];\n  var prefix = caps.w3cPrefix || 'wd';\n\n  for (var i = 0; i < pairs.length; i++) {\n    var key = pairs[i][0];\n    var value = pairs[i][1]; // If an unsupported cap has no prefix, add one.\n\n    if (key.indexOf(':') < 0 && w3cCapabilities.indexOf(key) < 0) {\n      prefixedCaps[prefix + ':' + key] = value;\n    } else {\n      prefixedCaps[key] = value;\n    }\n  }\n\n  return prefixedCaps;\n};\n\nvar w3cElementKeyId = exports.w3cElementKeyId = \"element-6066-11e4-a52e-4f735466cecf\";\n\nexports.getElementId = function (obj) {\n  return _.isObject(obj) ? obj.ELEMENT || obj[w3cElementKeyId] : undefined;\n};","map":{"version":3,"sources":["/home/yanxiaoyang/react-project/PersonalWebsiteTest/node_modules/wd/lib/utils.js"],"names":["Args","require","Constructor","_","url","JSONWIRE_ERRORS","varargs","exports","args","fargs","callback","callbackGiven","undefined","findCallback","_arguments","STRAT_MAPPING","elFuncSuffix","type","suffix","replace","$1","toUpperCase","elFuncFullType","elementFuncTypes","Q_CORE_METHODS","transferPromiseness","assertion","promise","each","methodName","_obj","bind","_enrich","isPromise","x","then","deprecator","deprecationMessageShown","warnDeprecated","showHideDeprecation","status","warn","cat","message","console","inlineJs","script","trim","resolveUrl","from","to","format","match","parse","resolve","strip","str","length","times","i","charCodeAt","push","charAt","join","trimToLength","substring","niceArgs","JSON","stringify","niceResp","codeToString","code","MAX_ERROR_LENGTH","newError","opts","err","Error","opt","k","inspect","jsonStr","isWebDriverException","res","class","indexOf","getJsonwireError","jsonwireError","filter","prefixCapabilities","caps","pairs","toPairs","prefixedCaps","w3cCapabilities","prefix","w3cPrefix","key","value","w3cElementKeyId","getElementId","obj","isObject","ELEMENT"],"mappings":"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","sourcesContent":["var Args = require(\"vargs\").Constructor,\n    _ = require('lodash'),\n    url = require('url'),\n    JSONWIRE_ERRORS = require('./jsonwire-errors.js');\n\nvar varargs = exports.varargs = function(args) {\n  var fargs = new(Args)(args);\n  // returning undefined instead of empty callback\n  fargs.callback = fargs.callbackGiven()? fargs.callback : undefined;\n  return fargs;\n};\n\n// small helper to make sure we don't loose exceptions\n// use this instead of looking  the last argument manually\nexports.findCallback = function(_arguments){\n  var fargs = varargs(_arguments);\n  return fargs.callback;\n};\n\n// convert to type to something like ById, ByCssSelector, etc...\nvar STRAT_MAPPING = {\n  '-ios uiautomation': 'ByIosUIAutomation',\n  '-android uiautomator': 'ByAndroidUIAutomator',\n  '-android datamatcher': 'ByAndroidDataMatcher',\n  '-ios class chain': 'ByIosClassChain',\n  '-ios predicate string': 'ByIosPredicateString',\n  '-image': 'ByImage',\n  '-custom': 'ByCustom',\n};\nexports.elFuncSuffix = function(type){\n  var suffix = STRAT_MAPPING[type];\n  if(!suffix) {\n    suffix = (' by ' + type).replace(/(\\s[a-z])/g,\n      function($1){return $1.toUpperCase().replace(' ','');})\n      .replace('Xpath', 'XPath');\n  }\n  return suffix;\n};\n\n// return correct jsonwire type\nexports.elFuncFullType = function(type){\n  if(type === 'css') {return 'css selector'; } // shortcut for css\n  return type;\n};\n\n// from JsonWire spec + shortcuts + mobile JsonWire spec\nexports.elementFuncTypes = ['class name', 'css selector','id','name',\n  'link text', 'partial link text','tag name', 'xpath', 'css',\n  '-ios uiautomation', '-android uiautomator', 'accessibility id',\n  '-ios class chain', '-ios predicate string', '-image', '-custom', '-android datamatcher'];\n\n// chai-as-promised promisifier\n// just adding the core method for the sake of safety.\\\n// if you need more than that, build your custom promisifier\nvar Q_CORE_METHODS = [\n    // core methods:\n     \"then\", \"catch\", \"fail\", \"progress\", \"finally\", \"fin\", \"done\",\n     \"thenResolve\", \"thenReject\", \"nodeify\"\n];\n\nexports.transferPromiseness = function(assertion, promise) {\n    _(Q_CORE_METHODS).each(function(methodName) {\n      if (promise[methodName]) {\n        if(assertion._obj) {\n          assertion._obj[methodName] = promise[methodName].bind(promise);\n        }\n        assertion[methodName] = promise[methodName].bind(promise);\n      }\n  });\n  if(promise._enrich) {\n    if(assertion._obj) {\n      promise._enrich(assertion._obj);\n    }\n    promise._enrich(assertion);\n  }\n};\n\n// promise detection\nexports.isPromise = function(x) {\n  return (typeof x === \"object\" || typeof x === \"function\") && x !== null && typeof x.then === \"function\";\n};\n\nexports.deprecator = {\n  deprecationMessageShown: {},\n  warnDeprecated: true,\n  showHideDeprecation: function(status) {\n    if(status !== undefined) { this.warnDeprecated = status; }\n    else { this.warnDeprecated = !this.warnDeprecated; }\n  },\n  warn: function(cat, message) {\n    if(this.warnDeprecated && !this.deprecationMessageShown[cat]) {\n      this.deprecationMessageShown[cat] = 1;\n      console.warn(message); // eslint-disable-line no-console\n    }\n  }\n};\n\n// Android doesn't like cariage return\nexports.inlineJs = function(script) {\n  return script.replace(/[\\r\\n]/g,'').trim();\n};\n\nexports.resolveUrl = function(from, to) {\n  if(typeof from === 'object') { from = url.format(from); }\n\n  // making sure the last part of the path doesn't get stripped\n  if(!from.match(/\\/$/)) { from += '/'; }\n\n  return url.parse(url.resolve(from, to));\n};\n\nexports.strip = function strip(str) {\n  if(typeof(str) !== 'string') { return str; }\n  var x = [];\n  _(str.length).times(function(i) {\n    if (str.charCodeAt(i)) {\n      x.push(str.charAt(i));\n    }\n  });\n  return x.join('');\n};\n\nvar trimToLength = function(str, length) {\n  return (str && str.length > length)?\n    str.substring(0,length) + '...' : str;\n};\nexports.trimToLength = trimToLength;\n\nexports.niceArgs = function(args) {\n  return JSON.stringify(args)\n    .replace(/^\\[/, '(')\n    .replace(/\\]$/, ')');\n};\n\nexports.niceResp = function(args) {\n  return JSON.stringify(args)\n    .replace(/^\\[/, '')\n    .replace(/\\]$/, '');\n};\n\n// convert code to string before execution\nexports.codeToString = function(code) {\n  if(typeof code === 'function') {\n    code = 'return (' + code + ').apply(null, arguments);';\n  }\n  return code;\n};\n\nvar MAX_ERROR_LENGTH = 500;\nexports.newError = function(opts)\n{\n  var err = new Error();\n  _.each(opts, function(opt, k) {\n    err[k] = opt;\n  });\n  // nicer error output\n  err.inspect = function() {\n    var jsonStr = JSON.stringify(err);\n    return trimToLength(jsonStr, MAX_ERROR_LENGTH);\n  };\n  return err;\n};\n\nexports.isWebDriverException = function(res) {\n  return res &&\n         res.class &&\n         (res.class.indexOf('WebDriverException') > 0);\n};\n\nexports.getJsonwireError = function(status) {\n  var jsonwireError = JSONWIRE_ERRORS.filter(function(err) {\n    return err.status === status;\n  });\n  return ((jsonwireError.length>0) ? jsonwireError[0] : null);\n};\n\n/**\n * Prefix all unofficial capabilities. Prefix with `wd` by default\n * or with whatever is provided in `caps.w3cPrefix`\n */\nexports.prefixCapabilities = function (caps) {\n  var pairs = _.toPairs(caps);\n  var prefixedCaps = {};\n  var w3cCapabilities = [\n    'browserName', 'browserVersion', 'platformName', 'acceptInsecureCerts',\n    'pageLoadStrategy', 'proxy', 'setWindowRect', 'timeouts', 'unhandledPromptBehavior'\n  ];\n  var prefix = caps.w3cPrefix || 'wd';\n  for (var i=0; i<pairs.length; i++) {\n    var key = pairs[i][0];\n    var value = pairs[i][1];\n\n    // If an unsupported cap has no prefix, add one.\n    if (key.indexOf(':') < 0 && w3cCapabilities.indexOf(key) < 0) {\n      prefixedCaps[prefix + ':' + key] = value;\n    } else {\n      prefixedCaps[key] = value;\n    }\n  }\n  return prefixedCaps;\n};\n\nvar w3cElementKeyId = exports.w3cElementKeyId = \"element-6066-11e4-a52e-4f735466cecf\";\n\nexports.getElementId = function (obj) {\n  return _.isObject(obj) ? obj.ELEMENT || obj[w3cElementKeyId] : undefined;\n};\n"]},"metadata":{},"sourceType":"script"}